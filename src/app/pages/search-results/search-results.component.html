<app-header-center></app-header-center>
<!-- Page Content -->
<div class="content">
  <div class="container-fluid">

    <div class="row">
      <div class="col-md-12 col-lg-4 col-xl-3 theiaStickySidebar">

        <!-- Search Filter -->
        <div class="card search-filter">
          <div class="card-header">
            <h4 class="card-title mb-0">Search Filter</h4>
          </div>
          <div class="card-body">
            <div class="filter-widget">
              <div class="">
                <input type="text" class="form-control" placeholder="Query" [(ngModel)]="searchQuery" (keydown.enter)="performSearch()">
              </div>
            </div>
            <div class="filter-widget">
              <h4>Select Categories</h4>
              <div *ngFor="let category of categories">
                <label class="custom_check">
                  <input type="checkbox" [checked]="searchCategories.includes(category.name)"
                    (change)="toggleCategory(category.name)">
                  <span class="checkmark"></span> {{ category.name }}
                </label>
              </div>
            </div>
            <div class="btn-search">
              <button type="button" class="btn btn-block w-100" (click)="performSearch(false)">Search</button>
            </div>
          </div>
        </div>
        <!-- /Search Filter -->

      </div>

      <div *ngIf="isLoading" class="loading">
        Loading...
      </div>

      <div *ngIf="hasError" class="error">
        Failed to fetch search results. Please try again later.
      </div>

      <div *ngIf="!isLoading && !hasError && searchResults.length === 0" class="no-results">
        No results found for "{{ searchQuery }}".
      </div>

      <div class="col-md-12 col-lg-8 col-xl-9" *ngIf="!isLoading && !hasError && searchResults.length > 0">
        <div class="card" *ngFor="let mentor of searchResults">
          <div class="card-body">
            <div class="mentor-widget">
              <div class="user-info-left">
                <div class="mentor-img">
                  <a [href]="'/payment/' + mentor.id">
                    <img [src]="mentor.listingImagePath" class="img-fluid" [alt]="mentor.tutorName">
                  </a>
                </div>
                <div class="user-info-cont">
                  <h4 class="usr-name"><a [href]="'/payment/' + mentor.id">{{ mentor.tutorName }}</a></h4>
                  <p class="mentor-type">{{ mentor.lessonCategory }}</p>
                  <div class="rating">
                    <i *ngFor="let star of [1, 2, 3, 4, 5]" class="fas" [ngClass]="{'fa-star filled': star <= (mentor.rating ? mentor.rating : 4.5), 
                                        'fa-star': star > (mentor.rating ? mentor.rating : 4.5)}">
                    </i>
                    <span class="d-inline-block average-rating">({{ mentor.reviews }})</span>
                  </div>
                  <div class="mentor-details">
                    <p class="user-location"><i class="fas fa-map-marker-alt"></i> {{ "location" }}</p>
                  </div>
                </div>
              </div>
              <div class="user-info-right">
                <div class="user-infos">
                  <ul>
                    <li><i class="far fa-comment"></i> {{ mentor.reviews }} Feedback</li>
                    <li><i class="fas fa-map-marker-alt"></i> {{ "location" }}</li>
                    <li><i class="far fa-money-bill-alt"></i> {{ mentor.rates.hourly }} <i class="fas fa-info-circle"
                        data-bs-toggle="tooltip" title="Lesson Pricing"></i></li>
                  </ul>
                </div>
                <div class="mentor-booking">
                  <a class="apt-btn" [href]="'/payment/' + mentor.id">Book Appointment</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Load More Button -->
        <div class="load-more text-center" *ngIf="searchResults.length < totalResults && !isLoadingMore">
          <input type="button" class="btn btn-primary btn-sm" value="Load More" (click)="loadMoreResults()" />
        </div>

        <div *ngIf="isLoadingMore" class="loading-more">
          Loading more...
        </div>
      </div>

    </div>

  </div>

</div>
<!-- /Page Content -->